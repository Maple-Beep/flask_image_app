{% extends "base.html" %}
{% block title %}å¿˜è®°å¯†ç {% endblock %}
{% block content %}
<style>
    .forgot-password-container {
        max-width: 520px;
        margin: 0 auto;
    }
    
    .forgot-header {
        text-align: center;
        margin-bottom: 2.5rem;
    }
    
    .forgot-icon {
        width: 80px;
        height: 80px;
        margin: 0 auto 1.5rem;
        background: var(--primary-gradient);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 2.5rem;
        animation: float 3s ease-in-out infinite;
    }
    
    @keyframes float {
        0%, 100% { transform: translateY(0); }
        50% { transform: translateY(-10px); }
    }
    
    .forgot-header h1 {
        font-size: 2.5rem;
        margin-bottom: 0.5rem;
    }
    
    .forgot-header p {
        font-size: 1.1rem;
        color: var(--text-muted);
    }
    
    .step-indicator {
        display: flex;
        justify-content: center;
        gap: 15px;
        margin-bottom: 2.5rem;
    }
    
    .step-dot {
        width: 12px;
        height: 12px;
        border-radius: 50%;
        background: var(--border-color);
        transition: all 0.3s ease;
    }
    
    .step-dot.active {
        width: 30px;
        border-radius: 6px;
        background: var(--primary-gradient);
    }
    
    .form-group {
        margin-bottom: 1.5rem;
        position: relative;
    }
    
    .form-group label {
        display: block;
        margin-bottom: 0.5rem;
        font-weight: 500;
        color: var(--text-color);
    }
    
    .form-group input {
        width: 100%;
        padding: 14px 18px 14px 50px;
        background: var(--glass-bg);
        border: 1px solid var(--glass-border);
        border-radius: 12px;
        font-size: 1rem;
        color: var(--text-color);
        transition: all 0.3s ease;
        font-family: 'Noto Sans SC', sans-serif;
    }
    
    .form-group input:focus {
        outline: none;
        border-color: #667eea;
        background: rgba(102, 126, 234, 0.05);
        box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
    }
    
    .input-icon {
        position: absolute;
        left: 18px;
        top: 43px;
        color: var(--text-muted);
        font-size: 1.2rem;
        pointer-events: none;
    }
    
    .submit-btn {
        width: 100%;
        padding: 15px;
        font-size: 1.05rem;
        font-weight: 600;
    }
    
    .info-box {
        background: rgba(102, 126, 234, 0.1);
        border-left: 4px solid #667eea;
        padding: 1rem 1.5rem;
        border-radius: 8px;
        margin-bottom: 2rem;
        animation: slideInLeft 0.4s ease-out;
    }
    
    @keyframes slideInLeft {
        from {
            opacity: 0;
            transform: translateX(-20px);
        }
        to {
            opacity: 1;
            transform: translateX(0);
        }
    }
    
    .info-box p {
        margin: 0;
        color: #a0aeff;
        font-size: 0.95rem;
    }
    
    .success-box {
        background: rgba(81, 207, 102, 0.1);
        border-left-color: var(--success-color);
    }
    
    .success-box p {
        color: var(--success-color);
    }
    
    .back-link {
        display: block;
        text-align: center;
        margin-top: 2rem;
        padding-top: 2rem;
        border-top: 1px solid var(--border-color);
    }
    
    .back-link a {
        color: var(--text-muted);
        font-size: 0.95rem;
    }
    
    .verification-input {
        text-align: center;
        letter-spacing: 8px;
        font-size: 1.3rem;
        font-weight: 600;
        font-family: 'Courier New', monospace;
    }
    
    .password-match-indicator {
        display: flex;
        align-items: center;
        gap: 8px;
        margin-top: 8px;
        font-size: 0.85rem;
        color: var(--text-muted);
    }
    
    .password-match-indicator.match {
        color: var(--success-color);
    }
    
    .password-match-indicator.no-match {
        color: var(--error-color);
    }
</style>

<div class="forgot-password-container">
    <div class="forgot-header">
        <div class="forgot-icon">ğŸ”‘</div>
        <h1>é‡ç½®å¯†ç </h1>
        <p>æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤æ‰¾å›æ‚¨çš„è´¦æˆ·</p>
    </div>
    
    <div class="step-indicator">
        <div class="step-dot {% if step == 1 %}active{% endif %}"></div>
        <div class="step-dot {% if step == 2 %}active{% endif %}"></div>
        <div class="step-dot {% if step == 3 %}active{% endif %}"></div>
    </div>

    {% if step == 1 %}
    <div class="info-box">
        <p>ğŸ’¡ è¯·è¾“å…¥æ‚¨æ³¨å†Œæ—¶ä½¿ç”¨çš„é‚®ç®±åœ°å€ï¼Œæˆ‘ä»¬å°†å‘é€éªŒè¯ç åˆ°è¯¥é‚®ç®±</p>
    </div>
    
    <form method="POST">
        <div class="form-group">
            <label for="email">é‚®ç®±åœ°å€</label>
            <span class="input-icon">ğŸ“§</span>
            <input type="email" id="email" name="email" placeholder="your@email.com" required>
        </div>
        <button type="submit" class="btn submit-btn">å‘é€éªŒè¯ç </button>
    </form>

    {% elif step == 2 %}
    <div class="info-box success-box">
        <p>âœ“ éªŒè¯ç å·²å‘é€è‡³æ‚¨çš„é‚®ç®±ï¼ˆè¯·æŸ¥çœ‹ PyCharm ç»ˆç«¯ï¼‰</p>
    </div>
    
    <form method="POST">
        <div class="form-group">
            <label for="verification_code">éªŒè¯ç </label>
            <span class="input-icon">ğŸ”¢</span>
            <input type="text" 
                   id="verification_code" 
                   name="verification_code" 
                   class="verification-input"
                   placeholder="000000" 
                   maxlength="6"
                   required>
        </div>
        <button type="submit" class="btn submit-btn">éªŒè¯</button>
    </form>
    
    <div style="text-align: center; margin-top: 1.5rem;">
        <a href="{{ url_for('forgot_password') }}" style="color: var(--text-muted); font-size: 0.9rem;">â† è¿”å›ä¸Šä¸€æ­¥</a>
    </div>

    {% elif step == 3 %}
    <div class="info-box success-box">
        <p>âœ“ éªŒè¯æˆåŠŸï¼è¯·è®¾ç½®æ‚¨çš„æ–°å¯†ç </p>
    </div>
    
    <form method="POST" id="resetForm">
        <div class="form-group">
            <label for="new_password">æ–°å¯†ç </label>
            <span class="input-icon">ğŸ”’</span>
            <input type="password" id="new_password" name="new_password" placeholder="è¯·è¾“å…¥æ–°å¯†ç ï¼ˆè‡³å°‘6ä½ï¼‰" required>
        </div>
        
        <div class="form-group">
            <label for="confirm_password">ç¡®è®¤æ–°å¯†ç </label>
            <span class="input-icon">âœ“</span>
            <input type="password" id="confirm_password" name="confirm_password" placeholder="è¯·å†æ¬¡è¾“å…¥æ–°å¯†ç " required>
            <div class="password-match-indicator" id="matchIndicator"></div>
        </div>
        
        <button type="submit" class="btn submit-btn">é‡ç½®å¯†ç </button>
    </form>
    
    <div style="text-align: center; margin-top: 1.5rem;">
        <a href="{{ url_for('forgot_password') }}" style="color: var(--text-muted); font-size: 0.9rem;">â† è¿”å›ä¸Šä¸€æ­¥</a>
    </div>
    
    <script>
        const newPassword = document.getElementById('new_password');
        const confirmPassword = document.getElementById('confirm_password');
        const matchIndicator = document.getElementById('matchIndicator');
        
        function checkPasswordMatch() {
            if (confirmPassword.value.length === 0) {
                matchIndicator.innerHTML = '';
                matchIndicator.className = 'password-match-indicator';
                return;
            }
            
            if (newPassword.value === confirmPassword.value) {
                matchIndicator.innerHTML = 'âœ“ å¯†ç åŒ¹é…';
                matchIndicator.className = 'password-match-indicator match';
            } else {
                matchIndicator.innerHTML = 'âœ— å¯†ç ä¸åŒ¹é…';
                matchIndicator.className = 'password-match-indicator no-match';
            }
        }
        
        newPassword.addEventListener('input', checkPasswordMatch);
        confirmPassword.addEventListener('input', checkPasswordMatch);
    </script>
    {% endif %}

    <div class="back-link">
        <a href="{{ url_for('login') }}">â† è¿”å›ç™»å½•</a>
    </div>
</div>
{% endblock %}
